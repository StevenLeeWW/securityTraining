<!DOCTYPE html>
<html>
<head>
    <title>SQL Injection Lab</title>
    <style>
        body { font-family: Arial, sans-serif; line-height: 1.6; }
        .exercise { margin-bottom: 30px; padding: 15px; border: 1px solid #ddd; }
        .code { background-color: #f5f5f5; padding: 10px; font-family: monospace; }
        .hint { color: #666; font-style: italic; }
    </style>
</head>
<body>
    <h1>SQL Injection Hands-On Lab</h1>
    
    <div class="exercise">
        <h2>Exercise 1: Basic SQL Injection</h2>
        <p>The Products search functionality is vulnerable to SQL Injection:</p>
        <div class="code">
            var command = new SqlCommand($"SELECT * FROM Products WHERE Name LIKE '%{search}%'", connection);
        </div>
        
        <p>Tasks:</p>
        <ol>
            <li>Access the application at http://localhost:8080/Products</li>
            <li>Enter the following in the search box: <code>' OR '1'='1</code></li>
            <li>What happens? Why?</li>
            <li>Try to modify your payload to retrieve only products with a price > $50</li>
        </ol>
        
        <p class="hint">Hint: The final query might look like: SELECT * FROM Products WHERE Name LIKE '%[your input]%'</p>
    </div>
    
    <div class="exercise">
        <h2>Exercise 2: Extracting User Data</h2>
        <p>Let's try to extract sensitive data from another table:</p>
        
        <p>Tasks:</p>
        <ol>
            <li>Construct a UNION-based SQL injection payload to retrieve usernames and passwords</li>
            <li>Enter your payload in the search box</li>
            <li>Document the information you were able to extract</li>
        </ol>
        
        <p class="hint">Hint: You'll need to match column counts between the tables. Try: <code>' UNION SELECT NULL, Username, Password, NULL, NULL, NULL FROM Users --</code></p>
    </div>
    
    <div class="exercise">
        <h2>Exercise 3: Fixing the Vulnerability</h2>
        <p>Now let's fix the vulnerable code:</p>
        <div class="code">
            // Original vulnerable code
            var command = new SqlCommand($"SELECT * FROM Products WHERE Name LIKE '%{search}%'", connection);
            
            // Rewrite this using parameterized queries
            // Your solution here:
            
        </div>
        
        <p>Tasks:</p>
        <ol>
            <li>Rewrite the above code using parameterized queries</li>
            <li>Explain why your solution prevents SQL injection</li>
        </ol>
    </div>
</body>
</html>