<!DOCTYPE html>
<html>
<head>
    <title>Application Security Hardening Lab</title>
    <style>
        body { font-family: Arial, sans-serif; line-height: 1.6; }
        .exercise { margin-bottom: 30px; padding: 15px; border: 1px solid #ddd; }
        .code { background-color: #f5f5f5; padding: 10px; font-family: monospace; }
        .hint { color: #666; font-style: italic; }
    </style>
</head>
<body>
    <h1>Application Security Hardening Lab</h1>
    
    <div class="exercise">
        <h2>Exercise 1: Comprehensive Security Hardening</h2>
        
        <p>Tasks:</p>
        <ol>
            <li>Create a comprehensive security hardening plan for the vulnerable web application</li>
            <li>Prioritize the fixes based on risk level</li>
            <li>Implement the most critical fixes</li>
            <li>Verify fixes with security testing</li>
        </ol>
        
        <p>Security Hardening Plan Template:</p>
        <div class="code">
            # Application Security Hardening Plan
            
            ## 1. High Priority Fixes
            
            ### Authentication Security
            - Issue: [Brief description]
              - Risk: High
              - Remediation:
              - Implementation steps:
              - Verification method:
            
            ### Authorization Controls
            - Issue: [Brief description]
              - Risk: High
              - Remediation:
              - Implementation steps:
              - Verification method:
            
            ### Injection Prevention
            - Issue: [Brief description]
              - Risk: High
              - Remediation:
              - Implementation steps:
              - Verification method:
            
            ## 2. Medium Priority Fixes
            
            ### XSS Prevention
            - Issue: [Brief description]
              - Risk: Medium
              - Remediation:
              - Implementation steps:
              - Verification method:
            
            ### CSRF Protection
            - Issue: [Brief description]
              - Risk: Medium
              - Remediation:
              - Implementation steps:
              - Verification method:
            
            ## 3. Low Priority Fixes
            
            ### Security Headers
            - Issue: [Brief description]
              - Risk: Low
              - Remediation:
              - Implementation steps:
              - Verification method:
            
            ### Information Disclosure
            - Issue: [Brief description]
              - Risk: Low
              - Remediation:
              - Implementation steps:
              - Verification method:
            
            ## 4. Implementation Timeline
            - Week 1: [Tasks]
            - Week 2: [Tasks]
            - Week 3: [Tasks]
            
            ## 5. Verification Plan
            - Security scanning:
            - Manual testing:
            - Code review:
        </div>
        
        <p class="hint">Hint: Focus on addressing the OWASP Top 10 risks systematically</p>
    </div>
    
    <div class="exercise">
        <h2>Exercise 2: Implementing Security Monitoring and Logging</h2>
        
        <p>Tasks:</p>
        <ol>
            <li>Analyze the current logging implementation:</li>
            <div class="code">
                // Current insecure logging
                public void Log<TState>(LogLevel logLevel, EventId eventId, TState state, Exception exception, Func<TState, Exception, string> formatter)
                {
                    // VULNERABILITY: Logging sensitive information without redaction
                    var message = formatter(state, exception);
                    
                    // VULNERABILITY: Writing logs to insecure location
                    File.AppendAllText("C:\\logs\\app_log.txt", $"{DateTime.Now} - {_categoryName} - {logLevel}: {message}\n");
                    
                    // VULNERABILITY: No structured logging, making security monitoring difficult
                    Console.WriteLine($"{DateTime.Now} - {_categoryName} - {logLevel}: {message}");
                }
            </div>
            <li>Implement a secure logging solution</li>
            <li>Create security monitoring capabilities</li>
            <li>Define security incident detection rules</li>
        </ol>
        
        <p>Implementation Template:</p>
        <div class="code">
            // Add your secure logging implementation here
            
            // Define security event types to monitor
            
            // Implement PII/sensitive data redaction
            
            // Create security monitoring alerts
        </div>
        
        <p class="hint">Hint: Consider structured logging with Serilog or NLog, and implement sensitive data redaction</p>
    </div>
    
    <div class="exercise">
        <h2>Exercise 3: Final Assessment - Building a Secure Web Application</h2>
        
        <p>This is a comprehensive exercise to apply all the security knowledge gained throughout the course.</p>
        
        <p>Tasks:</p>
        <ol>
            <li>Using the vulnerable application as a base, implement a fully secured version of the application</li>
            <li>Address all security vulnerabilities discussed in the course</li>
            <li>Document your security implementations with explanations of how they protect against various attack vectors</li>
            <li>Create a security checklist for future development</li>
        </ol>
        
        <p>Areas to focus on:</p>
        <ol>
            <li>Authentication and authorization</li>
            <li>Secure data storage and transmission</li>
            <li>Input validation and output encoding</li>
            <li>Security configuration</li>
            <li>Logging and monitoring</li>
            <li>Client-side security</li>
            <li>Error handling and management</li>
            <li>Secure development practices</li>
        </ol>
        
        <p class="hint">Hint: Work methodically through each security vulnerability category and document your changes</p>
    </div>
</body>
</html>